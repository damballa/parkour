<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>parkour.mapreduce documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Parkour 0.6.3 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="parkour.conf.html"><span>parkour.conf</span></a></li><li><a href="parkour.cser.html"><span>parkour.cser</span></a></li><li><a href="parkour.cser.printers.html"><span>parkour.cser.printers</span></a></li><li><a href="parkour.cser.readers.html"><span>parkour.cser.readers</span></a></li><li><a href="parkour.cstep.html"><span>parkour.cstep</span></a></li><li><a href="parkour.fs.html"><span>parkour.fs</span></a></li><li><a href="parkour.graph.html"><span>parkour.graph</span></a></li><li><a href="parkour.io.avro.html"><span>parkour.io.avro</span></a></li><li><a href="parkour.io.cascading.html"><span>parkour.io.cascading</span></a></li><li><a href="parkour.io.dseq.html"><span>parkour.io.dseq</span></a></li><li><a href="parkour.io.dsink.html"><span>parkour.io.dsink</span></a></li><li><a href="parkour.io.dux.html"><span>parkour.io.dux</span></a></li><li><a href="parkour.io.dval.html"><span>parkour.io.dval</span></a></li><li><a href="parkour.io.mem.html"><span>parkour.io.mem</span></a></li><li><a href="parkour.io.mux.html"><span>parkour.io.mux</span></a></li><li><a href="parkour.io.nline.html"><span>parkour.io.nline</span></a></li><li><a href="parkour.io.range.html"><span>parkour.io.range</span></a></li><li><a href="parkour.io.sample.html"><span>parkour.io.sample</span></a></li><li><a href="parkour.io.seqf.html"><span>parkour.io.seqf</span></a></li><li><a href="parkour.io.text.html"><span>parkour.io.text</span></a></li><li><a href="parkour.io.transient.html"><span>parkour.io.transient</span></a></li><li class="current"><a href="parkour.mapreduce.html"><span>parkour.mapreduce</span></a></li><li><a href="parkour.reducers.html"><span>parkour.reducers</span></a></li><li><a href="parkour.remote.input.html"><span>parkour.remote.input</span></a></li><li><a href="parkour.remote.sample.html"><span>parkour.remote.sample</span></a></li><li><a href="parkour.repl.html"><span>parkour.repl</span></a></li><li><a href="parkour.test-helpers.html"><span>parkour.test-helpers</span></a></li><li><a href="parkour.tool.html"><span>parkour.tool</span></a></li><li><a href="parkour.toolbox.html"><span>parkour.toolbox</span></a></li><li><a href="parkour.util.map-combine.html"><span>parkour.util.map-combine</span></a></li><li><a href="parkour.wrapper.html"><span>parkour.wrapper</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="parkour.mapreduce.html#var-*context*"><span>*context*</span></a></li><li><a href="parkour.mapreduce.html#var-collfn"><span>collfn</span></a></li><li><a href="parkour.mapreduce.html#var-combiner%21"><span>combiner!</span></a></li><li><a href="parkour.mapreduce.html#var-contextfn"><span>contextfn</span></a></li><li><a href="parkour.mapreduce.html#var-counters-map"><span>counters-map</span></a></li><li><a href="parkour.mapreduce.html#var-input-format%21"><span>input-format!</span></a></li><li><a href="parkour.mapreduce.html#var-job"><span>job</span></a></li><li><a href="parkour.mapreduce.html#var-keygroups"><span>keygroups</span></a></li><li><a href="parkour.mapreduce.html#var-keykeygroups"><span>keykeygroups</span></a></li><li><a href="parkour.mapreduce.html#var-keykeyvalgroups"><span>keykeyvalgroups</span></a></li><li><a href="parkour.mapreduce.html#var-keys"><span>keys</span></a></li><li><a href="parkour.mapreduce.html#var-keysgroups"><span>keysgroups</span></a></li><li><a href="parkour.mapreduce.html#var-keyvalgroups"><span>keyvalgroups</span></a></li><li><a href="parkour.mapreduce.html#var-keyvals"><span>keyvals</span></a></li><li><a href="parkour.mapreduce.html#var-local-runner%3F"><span>local-runner?</span></a></li><li><a href="parkour.mapreduce.html#var-mapper%21"><span>mapper!</span></a></li><li><a href="parkour.mapreduce.html#var-partfn"><span>partfn</span></a></li><li><a href="parkour.mapreduce.html#var-partitioner%21"><span>partitioner!</span></a></li><li><a href="parkour.mapreduce.html#var-recseqfn"><span>recseqfn</span></a></li><li><a href="parkour.mapreduce.html#var-reducer%21"><span>reducer!</span></a></li><li><a href="parkour.mapreduce.html#var-set-combiner"><span>set-combiner</span></a></li><li><a href="parkour.mapreduce.html#var-set-mapper"><span>set-mapper</span></a></li><li><a href="parkour.mapreduce.html#var-set-partitioner"><span>set-partitioner</span></a></li><li><a href="parkour.mapreduce.html#var-set-reducer"><span>set-reducer</span></a></li><li><a href="parkour.mapreduce.html#var-sink"><span>sink</span></a></li><li><a href="parkour.mapreduce.html#var-sink-as"><span>sink-as</span></a></li><li><a href="parkour.mapreduce.html#var-source-as"><span>source-as</span></a></li><li><a href="parkour.mapreduce.html#var-tac"><span>tac</span></a></li><li><a href="parkour.mapreduce.html#var-task-ex"><span>task-ex</span></a></li><li><a href="parkour.mapreduce.html#var-valgroups"><span>valgroups</span></a></li><li><a href="parkour.mapreduce.html#var-vals"><span>vals</span></a></li><li><a href="parkour.mapreduce.html#var-wrap-sink"><span>wrap-sink</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>parkour.mapreduce documentation</h2><pre class="doc"></pre><div class="public" id="var-*context*"><h3>*context*</h3><div class="usage"></div><pre class="doc">The task context.  Only bound during the dynamic scope of a task.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L20">Source</a></div></div><div class="public" id="var-collfn"><h3>collfn</h3><div class="usage"><code>(collfn v)</code></div><pre class="doc">Task function adapter for collection-function-like functions.  The adapted
function `v` should accept conf-provided arguments followed by the (unwrapped)
input tuple source, and should return a reducible collection of output tuples.
If `v` has metadata for the `::mr/source-as` or `::mr/sink-as` keys, the
function input and/or output will be re-shaped as specified via the associated
metadata value.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L107">Source</a></div></div><div class="public" id="var-combiner%21"><h3>combiner!</h3><div class="usage"><code>(combiner! conf var &amp; args)</code></div><pre class="doc">As per `reducer!`, but allocate and configure for the Hadoop combine step,
which may impact e.g. output types.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L271">Source</a></div></div><div class="public" id="var-contextfn"><h3>contextfn</h3><div class="usage"><code>(contextfn v)</code></div><pre class="doc">Task function adapter for functions accessing the job context.  The adapted
function `v` should accept a configuration followed by any conf-provided
arguments, and should return a function.  The returned function should accept
the job context and an (unwrapped) input tuple source, and should return a
reducible collection of output tuples.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L125">Source</a></div></div><div class="public" id="var-counters-map"><h3>counters-map</h3><div class="usage"><code>(counters-map counters)</code></div><pre class="doc">Translate job `counters` into nested Clojure map of strings to counts.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L341">Source</a></div></div><div class="public" id="var-input-format%21"><h3>input-format!</h3><div class="usage"><code>(input-format! conf svar sargs rvar rargs)</code></div><pre class="doc">Allocate and return a new input format class for `conf` as invoking `svar` to
generate input-splits and invoking `rvar` to generate record-readers.

During local job initialization, the function referenced by `svar` will be
invoked with the job context followed by any provided `sargs` (which must be
EDN-serializable); it should return a sequence of input split data.  Any values
in the returned sequence which are not `InputSplit`s will be wrapped in
`EdnInputSplit`s and must be EDN-serializable; in such a case, the `::mr/length`
and `::mr/locations` keys of such data may provide the split byte-size and node
locations respectively.

Prior to use, the function reference by `rvar` will be transformed by the
function specified as the value of the `readerv`'s `::mr/adapter` metadata,
defaulting to `parkour.mapreduce/recseqfn`.  During remote task-setup, the
transformed function will be invoked with the task input split and task context
followed by any provided `rargs`; it should return a `RecordReader` generating
the task input data.

See also: `recseqfn`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L194">Source</a></div></div><div class="public" id="var-job"><h3>job</h3><div class="usage"><code>(job)</code><code>(job conf)</code></div><pre class="doc">Return new Hadoop `Job` instance, optionally initialized with configuration
`conf`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L176">Source</a></div></div><div class="public" id="var-keygroups"><h3>keygroups</h3><div class="usage"><code>(keygroups context)</code></div><pre class="doc">Produce distinct keys from the tuples in `context`.  Deprecated.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L49">Source</a></div></div><div class="public" id="var-keykeygroups"><h3>keykeygroups</h3><div class="usage"><code>(keykeygroups context)</code></div><pre class="doc">Produce pairs of distinct grouping keys and associated sequences of specific
keys from the tuples in `context`.  Deprecated.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L68">Source</a></div></div><div class="public" id="var-keykeyvalgroups"><h3>keykeyvalgroups</h3><div class="usage"><code>(keykeyvalgroups context)</code></div><pre class="doc">Produce pairs of distinct grouping keys and associated sequences of specific
keys and values from the tuples in `context`.  Deprecated.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L63">Source</a></div></div><div class="public" id="var-keys"><h3>keys</h3><div class="usage"><code>(keys context)</code></div><pre class="doc">Produce keys only from the tuples in `context`.  Deprecated.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L37">Source</a></div></div><div class="public" id="var-keysgroups"><h3>keysgroups</h3><div class="usage"><code>(keysgroups context)</code></div><pre class="doc">Produce sequences of specific keys associated with distinct grouping keys
from the tuples in `context`.  Deprecated.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L73">Source</a></div></div><div class="public" id="var-keyvalgroups"><h3>keyvalgroups</h3><div class="usage"><code>(keyvalgroups context)</code></div><pre class="doc">Produce pairs of distinct group keys and associated sequences of values from
the tuples in `context`.  Deprecated.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L58">Source</a></div></div><div class="public" id="var-keyvals"><h3>keyvals</h3><div class="usage"><code>(keyvals context)</code></div><pre class="doc">Produce pairs of keys and values from the tuples in `context`.  Deprecated.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L45">Source</a></div></div><div class="public" id="var-local-runner%3F"><h3>local-runner?</h3><div class="usage"><code>(local-runner? conf)</code></div><pre class="doc">True iff `conf` specifies the local job runner.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L30">Source</a></div></div><div class="public" id="var-mapper%21"><h3>mapper!</h3><div class="usage"><code>(mapper! conf var &amp; args)</code></div><pre class="doc">Allocate and return a new mapper class for `conf` as invoking `var`.

Prior to use, the function referenced by `var` will be transformed by the
function specified as the value of `var`'s `::mr/adapter` metadata, defaulting
to `parkour.mapreduce/collfn`.  During task-setup, the transformed function will
be invoked with the job `Configuration` and any provided `args` (which must be
EDN-serializable); it should return a function of one argument, which will be
invoked with the task context to execute the task.

See also: `collfn`, `contextfn`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L225">Source</a></div></div><div class="public" id="var-partfn"><h3>partfn</h3><div class="usage"><code>(partfn v)</code></div><pre class="doc">Partitioner function adapter for value-based partitioners.  The adapted
function `v` should accept a configuration followed by any conf-provided
arguments, and should return a function.  The returned function should accept
an (unwrapped) tuple key, (unwrapped) tuple value, and a partition-count; it
should return an integer modulo the partition-count, and should optionally be
primitive-hinted as OOLL.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L137">Source</a></div></div><div class="public" id="var-partitioner%21"><h3>partitioner!</h3><div class="usage"><code>(partitioner! conf var &amp; args)</code></div><pre class="doc">Allocate and return a new partitioner class for `conf` as invoking `var`.

Prior to use, the function referenced by `var` will be transformed by the
function specified as the value of `var`'s `::mr/adapter` metadata, defaulting
to the `(comp parkour.mapreduce/partfn constantly)`.  During task-setup, the
transformed function will be invoked with the job `Configuration` and any
provided `args` (which must be EDN-serializable); it should return a function of
three arguments: a raw map-output key, a raw map-output value, and an integral
reduce-task count.  That function will be called for each map-output tuple, must
return an integral value mod the reduce-task count, and must be primitive-hinted
as `OOLL`.

See also: `partfn`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L277">Source</a></div></div><div class="public" id="var-recseqfn"><h3>recseqfn</h3><div class="usage"><code>(recseqfn v)</code></div><pre class="doc">Input format record-reader creation function adapter for input formats
implemented in terms of seqs.  The adapted function `v` should accept an input
split and a task context, and should return a value which is `seq`able,
`count`able, and optionally `Closeable`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L155">Source</a></div></div><div class="public" id="var-reducer%21"><h3>reducer!</h3><div class="usage"><code>(reducer! conf var &amp; args)</code></div><pre class="doc">Allocate and return a new reducer class for `conf` as invoking `var`.

Prior to use, the function referenced by `var` will be transformed by the
function specified as the value of `var`'s `::mr/adapter` metadata, defaulting
to `parkour.mapreduce/collfn`.  During task-setup, the transformed function will
be invoked with the job `Configuration` and any provided `args` (which must be
EDN-serializable); it should return a function of one argument, which will be
invoked with the task context to execute the task.

See also: `collfn`, `contextfn`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L257">Source</a></div></div><div class="public" id="var-set-combiner"><h3>set-combiner</h3><div class="usage"><code>(set-combiner job cls)</code></div><pre class="doc">Set the combiner class for `job` to `cls`.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L302">Source</a></div></div><div class="public" id="var-set-mapper"><h3>set-mapper</h3><div class="usage"><code>(set-mapper job cls)</code></div><pre class="doc">Set the mapper class for `job` to `cls`.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L298">Source</a></div></div><div class="public" id="var-set-partitioner"><h3>set-partitioner</h3><div class="usage"><code>(set-partitioner job cls)</code></div><pre class="doc">Set the partitioner class for `job` to `cls`.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L310">Source</a></div></div><div class="public" id="var-set-reducer"><h3>set-reducer</h3><div class="usage"><code>(set-reducer job cls)</code></div><pre class="doc">Set the reducer class for `job` to `cls`.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L306">Source</a></div></div><div class="public" id="var-sink"><h3>sink</h3><div class="usage"><code>(sink coll)</code><code>(sink sink coll)</code></div><pre class="doc">Emit all tuples from `coll` to `sink`, or to `*context*` if not provided.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L102">Source</a></div></div><div class="public" id="var-sink-as"><h3>sink-as</h3><div class="usage"><code>(sink-as kind coll)</code></div><pre class="doc">Annotate `coll` as containing values to sink as `kind`.  The `kind` may
either be a sinking function of two arguments (a sink and a collection) or a
keyword indicating a built-in sinking function.  Supported keywords are `:none`,
`:keys`, `:vals`, and `:keyvals`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L95">Source</a></div></div><div class="public" id="var-source-as"><h3>source-as</h3><div class="usage"><code>(source-as kind source)</code></div><pre class="doc">Shape `source` to the collection shape `kind`.  The `kind` may either be a
source-shaping function of one argument or a keyword indicating a built-in
source-shaping function.  Supported keywords are: `:keys`, `:vals`, `:keyvals`,
`:keygroups`, `:valgroups`, :keyvalgroups`, `:keykeyvalgroups`,
`:keykeygroups`, and `:keysgroups`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L78">Source</a></div></div><div class="public" id="var-tac"><h3>tac</h3><div class="usage"><code>(tac conf)</code><code>(tac conf id)</code></div><pre class="doc">Return a new TaskAttemptContext instance using provided configuration `conf`
and task attempt ID `taid`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L334">Source</a></div></div><div class="public" id="var-task-ex"><h3>task-ex</h3><div class="usage"></div><pre class="doc">Atom holding any exception thrown during local execution.  Intended only for
internal use within Parkour.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L25">Source</a></div></div><div class="public" id="var-valgroups"><h3>valgroups</h3><div class="usage"><code>(valgroups context)</code></div><pre class="doc">Produce sequences of values associated with distinct grouping keys from the
tuples in `context`.  Deprecated.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L53">Source</a></div></div><div class="public" id="var-vals"><h3>vals</h3><div class="usage"><code>(vals context)</code></div><pre class="doc">Produce values only from the tuples in `context`.  Deprecated.
</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L41">Source</a></div></div><div class="public" id="var-wrap-sink"><h3>wrap-sink</h3><div class="usage"><code>(wrap-sink sink)</code><code>(wrap-sink ckey cval sink)</code></div><pre class="doc">Return new tuple sink which wraps keys and values as the types `ckey` and
`cval` respectively, which should be compatible with the key and value type of
`sink`.  Where they are not compatible, the type of the `sink` will be used
instead.  Returns a new tuple sink which wraps any sunk keys and values which
are not already of the correct type then sinks them to `sink`.</pre><div class="src-link"><a href="https://github.com/damballa/parkour/blob/master/src/clojure/parkour/mapreduce.clj#L86">Source</a></div></div></div></body></html>